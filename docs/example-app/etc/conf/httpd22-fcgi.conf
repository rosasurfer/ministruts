<VirtualHost *:80>
    ServerName        myapp.example.com
    ServerAlias local.myapp.example.com
    ServerAdmin default

    UseCanonicalName Off

    DocumentRoot "${SITES}/myapp.example.com/web"
    CustomLog    "${SITES}/myapp.example.com/etc/log/httpd-access.log"  combined
    ErrorLog     "${SITES}/myapp.example.com/etc/log/httpd-error.log"

    <Directory />
        AllowOverride None
        Order deny,allow
        Deny from all
    </Directory>
    <Directory "${SITES}/myapp.example.com/web">
        Order allow,deny
        Allow from all
    </Directory>

    AddDefaultCharset UTF-8
    DirectoryIndex index.html index.php
    Options FollowSymLinks

    RewriteEngine On
    RewriteCond   %{DOCUMENT_ROOT}%{REQUEST_FILENAME}  !-d
    RewriteCond   %{DOCUMENT_ROOT}%{REQUEST_FILENAME}  !-f
    RewriteRule   ^                                    /index.php  [QSA,L]
   #RewriteLog     "${SITES}/myapp.example.com/etc/log/mod-rewrite.log"
   #RewriteLogLevel 9

    # FcgidMaxRequestsPerProcess should be <= PHP_FCGI_MAX_REQUESTS
    # The example PHP wrapper script overrides the default PHP setting.
    FcgidMaxRequestsPerProcess 10000

    <Files "*.php">
        Options      +ExecCGI
        SetHandler   fcgid-script
        # If you use suEXEC the below command needs to reside in a permitted directory (see suexec -V).
        FcgidWrapper "${SITES}/myapp.example.com/etc/conf/cgi-bin/php-wrapper" .php
    </Files>
    <IfModule mod_suexec.c>
        SuexecUserGroup {username} {groupname}
    </IfModule>

    SetEnv APPLICATION_BASE_URI '/'
</VirtualHost>
